import { SANCTUM_URL } from '../../constants'
import NewHttpClient from './autogenerated/ts/http_client.js'

let keyLinkClient: (ReturnType<typeof NewHttpClient> & { accessToken: string }) | null = null;

export const getKeyLinkClient = (accessToken: string) => {
	if (keyLinkClient && keyLinkClient.accessToken === accessToken) {
		return keyLinkClient
	}
	return keyLinkClient = {
		...NewHttpClient({
			baseUrl: SANCTUM_URL || "",
			retrieveGuestAuth: async () => { return "" },
			retrieveUserAuth: async () => { throw new Error("User routes not enabled") },
			retrieveAccessTokenAuth: async () => { return accessToken },
			encryptCallback: async () => { throw new Error("encryption not enabled") },
			decryptCallback: async () => { throw new Error("encryption not enabled") },
			deviceId: "",
		}),
		accessToken: accessToken
	}
}

